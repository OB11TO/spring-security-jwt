# Проект Spring Security с JWT

Этот проект представляет собой базовое веб-приложение, разработанное с использованием Spring Security и JWT для обеспечения аутентификации и авторизации пользователей. Он включает в себя контроллеры для аутентификации и регистрации пользователей, а также обеспечивает сохранение пользовательских данных в базе данных PostgreSQL. Кроме того, проект поддерживает управление ролями пользователей и осуществляет авторизацию на основе этих ролей.

## Особенности проекта:

1. **JWT для аутентификации**: При успешной аутентификации пользователей генерируются их аксесс и рефреш токены в формате JWT, которые используются для последующей авторизации запросов.

2. **Сохранение токенов в Redis**: Для эффективного управления сеансами пользователей и их токенами используется Redis. Также существует API, который генерирует новый аксесс токен на основе рефреш токена.

3. **Хранение пользователей в PostgreSQL**: Данные пользователей, такие как их учетные записи и роли, сохраняются в базе данных PostgreSQL с использованием Liquibase для управления миграциями схемы базы данных.

4. **Управление ролями пользователей**: В приложении определены различные роли пользователей, такие как оператор, администратор рабочего места и администратор платформы. У каждой роли есть определенные привилегии и права доступа.

5. **Ограничение прав доступа**: Например, удаление пользователей разрешено только роли "Администратор рабочего места".

6. **Черный список токенов**: При выходе из системы (logout) аксесс токен помещается в черный список, который также хранится в Redis, чтобы предотвратить повторное использование старых токенов.

## Технологии:

- **Spring Boot**: Проект основан на Spring Boot, что обеспечивает простую конфигурацию и управление приложением.

- **Spring Security**: Используется для обеспечения аутентификации и авторизации пользователей.

- **JWT (JSON Web Tokens)**: Используется для создания токенов аутентификации.

- **PostgreSQL**: База данных PostgreSQL используется для хранения пользовательских данных.

- **Liquibase**: Используется для управления миграциями базы данных.

- **Redis**: Используется для хранения токенов сеансов пользователей и черного списка токенов.

### Запуск проекта

1. Склонируйте репозиторий на свой компьютер:

    ```bash
    git clone https://github.com/OB11TO/spring-security-jwt.git
    ```

2. Перейдите в каталог проекта:

    ```bash
    cd spring-security-jwt
    ```

3. Соберите и запустите контейнеры Docker с помощью Docker Compose:

    ```bash
    docker-compose up
    ```
### Порты и доступы

- **PostgreSQL**:
    - **Порт:** 5433
    - **База данных:** security
    - **Пользователь:** migration_user
    - **Пароль:** mgr_user
    - **Адрес:** localhost:5433 / в Docker контейнере: `postgres_container`

- **PgAdmin**:
    - **Порт:** 5050
    - **Логин:** admin@ob11to.ru
    - **Пароль:** admin
    - **Адрес:** localhost:5050
    - **Примечание:** PgAdmin предоставляет веб-интерфейс для управления PostgreSQL.

- **Redis**:
    - **Порт:** 6378
    - **Адрес:** localhost:6378 / в Docker контейнере: `redis_container` на порту 6379

- **Redis UI**:
    - **Порт:** 5540
    - **Адрес:** localhost:5540

- **Backend приложение**:
    - **Порт:** 8080
    - **Адрес:** localhost:8080
    - **OpenAPI:** [http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html)
    - **Конфигурация:** `application.yaml`, `application-docker.yaml`

### Примечания

- Приложение использует два файла конфигурации: `application.yaml` для локальной разработки и `application-docker.yaml` для Docker окружения. Убедитесь, что конфигурации соответствуют вашим требованиям.
- При необходимости изменения конфигурации, отредактируйте файлы `docker-compose.yaml`, `application.yaml` и `application-docker.yaml` согласно вашим потребностям.

### Важно!

- Перед использованием обязательно наличие VPN.
